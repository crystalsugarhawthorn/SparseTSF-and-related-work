数据形状：(52696, 21)，元素类型：float32
任务1数据集输入数据形状：(51881, 720, 21)，输出数据形状：(51881, 96, 21)
任务1训练集样本数：31128，验证集样本数：10376，测试集样本数：10377
Configs(seq_len=720, pred_len=96, enc_in=21, period_len=4, train_epochs=30, patience=5, flearning_rate=0.02, dataset_name=weather,model_type='linear')
每个 epoch 的 step 数量: 122
>>>>>>>>>开始训练>>>>>>>>>
第1/30轮
当前学习率调整为：0.02
训练集损失: 0.14098432660102844, 验证集损失: 0.09225878864526749, 测试集损失: 0.025106245651841164, 用时: 19.81s
结果图已保存到 train_result/weather_720_96_4_21_linear/result_1.pdf
验证损失降低 (inf --> 0.092259).  保存模型 于checkpoints/weather_720_96_4_21_linear/checkpoint.ckpt
第2/30轮
当前学习率调整为：0.02
训练集损失: 0.13307014107704163, 验证集损失: 0.08481547981500626, 测试集损失: 0.02422386221587658, 用时: 19.49s
验证损失降低 (0.092259 --> 0.084815).  保存模型 于checkpoints/weather_720_96_4_21_linear/checkpoint.ckpt
第3/30轮
当前学习率调整为：0.02
训练集损失: 0.1340840607881546, 验证集损失: 0.08595086634159088, 测试集损失: 0.02435658685863018, 用时: 19.62s
早停轮次: 1 out of 5
第4/30轮
当前学习率调整为：0.016
训练集损失: 0.13853958249092102, 验证集损失: 0.08775123953819275, 测试集损失: 0.024696988984942436, 用时: 19.58s
早停轮次: 2 out of 5
第5/30轮
当前学习率调整为：0.0128
训练集损失: 0.135413259267807, 验证集损失: 0.08721660077571869, 测试集损失: 0.024579202756285667, 用时: 19.68s
早停轮次: 3 out of 5
第6/30轮
当前学习率调整为：0.01024
训练集损失: 0.136830672621727, 验证集损失: 0.08862940222024918, 测试集损失: 0.02503192238509655, 用时: 19.58s
早停轮次: 4 out of 5
第7/30轮
当前学习率调整为：0.008192
训练集损失: 0.13854975998401642, 验证集损失: 0.08929809927940369, 测试集损失: 0.024645930156111717, 用时: 19.67s
早停轮次: 5 out of 5
Early stopping
训练完成！
>>>>>>>>>开始测试>>>>>>>>>
测试集损失: 0.02422386221587658
结果图已保存到 test_result/weather_720_96_4_21_linear/result_0.pdf
任务2数据集输入数据形状：(51785, 720, 21)，输出数据形状：(51785, 192, 21)
任务2训练集样本数：31071，验证集样本数：10357，测试集样本数：10357
Configs(seq_len=720, pred_len=192, enc_in=21, period_len=4, train_epochs=30, patience=5, flearning_rate=0.02, dataset_name=weather,model_type='linear')
每个 epoch 的 step 数量: 122
>>>>>>>>>开始训练>>>>>>>>>
第1/30轮
当前学习率调整为：0.02
训练集损失: 0.13442255556583405, 验证集损失: 0.09635629504919052, 测试集损失: 0.029017560184001923, 用时: 22.49s
结果图已保存到 train_result/weather_720_192_4_21_linear/result_1.pdf
验证损失降低 (inf --> 0.096356).  保存模型 于checkpoints/weather_720_192_4_21_linear/checkpoint.ckpt
第2/30轮
当前学习率调整为：0.02
训练集损失: 0.13165268301963806, 验证集损失: 0.09342770278453827, 测试集损失: 0.02937301993370056, 用时: 22.11s
验证损失降低 (0.096356 --> 0.093428).  保存模型 于checkpoints/weather_720_192_4_21_linear/checkpoint.ckpt
第3/30轮
当前学习率调整为：0.02
训练集损失: 0.13446518778800964, 验证集损失: 0.09541745483875275, 测试集损失: 0.029104599729180336, 用时: 22.19s
早停轮次: 1 out of 5
第4/30轮
当前学习率调整为：0.016
训练集损失: 0.1319168657064438, 验证集损失: 0.09279891103506088, 测试集损失: 0.02906615287065506, 用时: 22.43s
验证损失降低 (0.093428 --> 0.092799).  保存模型 于checkpoints/weather_720_192_4_21_linear/checkpoint.ckpt
第5/30轮
当前学习率调整为：0.0128
训练集损失: 0.13121744990348816, 验证集损失: 0.09155578166246414, 测试集损失: 0.029008733108639717, 用时: 22.21s
验证损失降低 (0.092799 --> 0.091556).  保存模型 于checkpoints/weather_720_192_4_21_linear/checkpoint.ckpt
第6/30轮
当前学习率调整为：0.01024
训练集损失: 0.13377398252487183, 验证集损失: 0.09367512911558151, 测试集损失: 0.02903064526617527, 用时: 23.64s
早停轮次: 1 out of 5
第7/30轮
当前学习率调整为：0.008192
训练集损失: 0.12999945878982544, 验证集损失: 0.08897434175014496, 测试集损失: 0.028922945261001587, 用时: 25.72s
验证损失降低 (0.091556 --> 0.088974).  保存模型 于checkpoints/weather_720_192_4_21_linear/checkpoint.ckpt
第8/30轮
当前学习率调整为：0.0065536
训练集损失: 0.13199210166931152, 验证集损失: 0.0918726697564125, 测试集损失: 0.028878338634967804, 用时: 34.11s
早停轮次: 1 out of 5
第9/30轮
当前学习率调整为：0.00524288
训练集损失: 0.13250254094600677, 验证集损失: 0.09214285016059875, 测试集损失: 0.02905512973666191, 用时: 26.88s
早停轮次: 2 out of 5
第10/30轮
当前学习率调整为：0.004194304
训练集损失: 0.1302802562713623, 验证集损失: 0.08930964022874832, 测试集损失: 0.028923867270350456, 用时: 22.65s
早停轮次: 3 out of 5
第11/30轮
当前学习率调整为：0.0033554432
训练集损失: 0.13157038390636444, 验证集损失: 0.09108938276767731, 测试集损失: 0.028982751071453094, 用时: 23.04s
结果图已保存到 train_result/weather_720_192_4_21_linear/result_11.pdf
早停轮次: 4 out of 5
第12/30轮
当前学习率调整为：0.0026843545
训练集损失: 0.131079763174057, 验证集损失: 0.09076633304357529, 测试集损失: 0.02906854636967182, 用时: 22.84s
早停轮次: 5 out of 5
Early stopping
训练完成！
>>>>>>>>>开始测试>>>>>>>>>
测试集损失: 0.028922945261001587
结果图已保存到 test_result/weather_720_192_4_21_linear/result_0.pdf
任务3数据集输入数据形状：(51641, 720, 21)，输出数据形状：(51641, 336, 21)
任务3训练集样本数：30984，验证集样本数：10328，测试集样本数：10329
Configs(seq_len=720, pred_len=336, enc_in=21, period_len=4, train_epochs=30, patience=5, flearning_rate=0.02, dataset_name=weather,model_type='linear')
每个 epoch 的 step 数量: 122
>>>>>>>>>开始训练>>>>>>>>>
第1/30轮
当前学习率调整为：0.02
训练集损失: 0.12622512876987457, 验证集损失: 0.12587788701057434, 测试集损失: 0.03316923975944519, 用时: 29.15s
结果图已保存到 train_result/weather_720_336_4_21_linear/result_1.pdf
验证损失降低 (inf --> 0.125878).  保存模型 于checkpoints/weather_720_336_4_21_linear/checkpoint.ckpt
第2/30轮
当前学习率调整为：0.02
训练集损失: 0.12366274744272232, 验证集损失: 0.12099400162696838, 测试集损失: 0.03214208036661148, 用时: 27.71s
验证损失降低 (0.125878 --> 0.120994).  保存模型 于checkpoints/weather_720_336_4_21_linear/checkpoint.ckpt
第3/30轮
当前学习率调整为：0.02
训练集损失: 0.1263311803340912, 验证集损失: 0.12497077137231827, 测试集损失: 0.03240666165947914, 用时: 28.42s
早停轮次: 1 out of 5
第4/30轮
当前学习率调整为：0.016
训练集损失: 0.11934670060873032, 验证集损失: 0.11351917684078217, 测试集损失: 0.032031234353780746, 用时: 28.26s
验证损失降低 (0.120994 --> 0.113519).  保存模型 于checkpoints/weather_720_336_4_21_linear/checkpoint.ckpt
第5/30轮
当前学习率调整为：0.0128
训练集损失: 0.11977522075176239, 验证集损失: 0.11466949433088303, 测试集损失: 0.031976476311683655, 用时: 27.53s
早停轮次: 1 out of 5
第6/30轮
当前学习率调整为：0.01024
训练集损失: 0.12436556071043015, 验证集损失: 0.12166097015142441, 测试集损失: 0.032391589134931564, 用时: 26.91s
早停轮次: 2 out of 5
第7/30轮
当前学习率调整为：0.008192
训练集损失: 0.1221371665596962, 验证集损失: 0.11804641038179398, 测试集损失: 0.03226609528064728, 用时: 27.21s
早停轮次: 3 out of 5
第8/30轮
当前学习率调整为：0.0065536
训练集损失: 0.12295573204755783, 验证集损失: 0.11889815330505371, 测试集损失: 0.03227407485246658, 用时: 27.03s
早停轮次: 4 out of 5
第9/30轮
当前学习率调整为：0.00524288
训练集损失: 0.12335516512393951, 验证集损失: 0.1193435862660408, 测试集损失: 0.03236500173807144, 用时: 28.76s
早停轮次: 5 out of 5
Early stopping
训练完成！
>>>>>>>>>开始测试>>>>>>>>>
测试集损失: 0.032031234353780746
结果图已保存到 test_result/weather_720_336_4_21_linear/result_0.pdf
任务4数据集输入数据形状：(51257, 720, 21)，输出数据形状：(51257, 720, 21)
任务4训练集样本数：30754，验证集样本数：10251，测试集样本数：10252
Configs(seq_len=720, pred_len=720, enc_in=21, period_len=4, train_epochs=30, patience=5, flearning_rate=0.02, dataset_name=weather,model_type='linear')
每个 epoch 的 step 数量: 121
>>>>>>>>>开始训练>>>>>>>>>
第1/30轮
当前学习率调整为：0.02
训练集损失: 0.1199074387550354, 验证集损失: 0.13098548352718353, 测试集损失: 0.03853755071759224, 用时: 46.53s
结果图已保存到 train_result/weather_720_720_4_21_linear/result_1.pdf
验证损失降低 (inf --> 0.130985).  保存模型 于checkpoints/weather_720_720_4_21_linear/checkpoint.ckpt
第2/30轮
当前学习率调整为：0.02
训练集损失: 0.11733384430408478, 验证集损失: 0.12604716420173645, 测试集损失: 0.03834647312760353, 用时: 44.88s
验证损失降低 (0.130985 --> 0.126047).  保存模型 于checkpoints/weather_720_720_4_21_linear/checkpoint.ckpt
第3/30轮
当前学习率调整为：0.02
训练集损失: 0.11473310738801956, 验证集损失: 0.12209959328174591, 测试集损失: 0.038167282938957214, 用时: 44.34s
验证损失降低 (0.126047 --> 0.122100).  保存模型 于checkpoints/weather_720_720_4_21_linear/checkpoint.ckpt
第4/30轮
当前学习率调整为：0.016
训练集损失: 0.11406014859676361, 验证集损失: 0.12087516486644745, 测试集损失: 0.038162197917699814, 用时: 45.08s
验证损失降低 (0.122100 --> 0.120875).  保存模型 于checkpoints/weather_720_720_4_21_linear/checkpoint.ckpt
第5/30轮
当前学习率调整为：0.0128
训练集损失: 0.11330687254667282, 验证集损失: 0.1192423403263092, 测试集损失: 0.03823922201991081, 用时: 44.51s
验证损失降低 (0.120875 --> 0.119242).  保存模型 于checkpoints/weather_720_720_4_21_linear/checkpoint.ckpt
第6/30轮
当前学习率调整为：0.01024
训练集损失: 0.11477600038051605, 验证集损失: 0.12158208340406418, 测试集损失: 0.03827564790844917, 用时: 39.01s
早停轮次: 1 out of 5
第7/30轮
当前学习率调整为：0.008192
训练集损失: 0.1131182461977005, 验证集损失: 0.11883243918418884, 测试集损失: 0.038313496857881546, 用时: 37.98s
验证损失降低 (0.119242 --> 0.118832).  保存模型 于checkpoints/weather_720_720_4_21_linear/checkpoint.ckpt
第8/30轮
当前学习率调整为：0.0065536
训练集损失: 0.1138952374458313, 验证集损失: 0.12014144659042358, 测试集损失: 0.03821961581707001, 用时: 39.84s
早停轮次: 1 out of 5
第9/30轮
当前学习率调整为：0.00524288
训练集损失: 0.11340279877185822, 验证集损失: 0.11930658668279648, 测试集损失: 0.03828267753124237, 用时: 38.16s
早停轮次: 2 out of 5
第10/30轮
当前学习率调整为：0.004194304
训练集损失: 0.11360061168670654, 验证集损失: 0.11964698135852814, 测试集损失: 0.038128968328237534, 用时: 37.67s
早停轮次: 3 out of 5
第11/30轮
当前学习率调整为：0.0033554432
训练集损失: 0.11374527961015701, 验证集损失: 0.11996045708656311, 测试集损失: 0.038096461445093155, 用时: 36.45s
结果图已保存到 train_result/weather_720_720_4_21_linear/result_11.pdf
早停轮次: 4 out of 5
第12/30轮
当前学习率调整为：0.0026843545
训练集损失: 0.11354200541973114, 验证集损失: 0.1195293664932251, 测试集损失: 0.03822341933846474, 用时: 36.52s
早停轮次: 5 out of 5
Early stopping
训练完成！
>>>>>>>>>开始测试>>>>>>>>>
测试集损失: 0.038313496857881546
结果图已保存到 test_result/weather_720_720_4_21_linear/result_0.pdf