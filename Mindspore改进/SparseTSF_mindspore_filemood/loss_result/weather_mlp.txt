数据形状：(52696, 21)，元素类型：float32
任务1数据集输入数据形状：(51881, 720, 21)，输出数据形状：(51881, 96, 21)
任务1训练集样本数：31128，验证集样本数：10376，测试集样本数：10377
Configs(seq_len=720, pred_len=96, enc_in=21, period_len=4, train_epochs=30, patience=5, flearning_rate=0.02, dataset_name=weather,model_type='mlp')
每个 epoch 的 step 数量: 122
>>>>>>>>>开始训练>>>>>>>>>
第1/30轮
当前学习率调整为：0.02
训练集损失: 0.15217524766921997, 验证集损失: 0.10470656305551529, 测试集损失: 0.026454705744981766, 用时: 23.48s
结果图已保存到 train_result/weather_720_96_4_21_mlp/result_1.pdf
验证损失降低 (inf --> 0.104707).  保存模型 于checkpoints/weather_720_96_4_21_mlp/checkpoint.ckpt
第2/30轮
当前学习率调整为：0.02
训练集损失: 0.13597208261489868, 验证集损失: 0.10497722774744034, 测试集损失: 0.025433987379074097, 用时: 24.24s
早停轮次: 1 out of 5
第3/30轮
当前学习率调整为：0.02
训练集损失: 0.12955060601234436, 验证集损失: 0.10149142146110535, 测试集损失: 0.026718756183981895, 用时: 23.97s
验证损失降低 (0.104707 --> 0.101491).  保存模型 于checkpoints/weather_720_96_4_21_mlp/checkpoint.ckpt
第4/30轮
当前学习率调整为：0.016
训练集损失: 0.12218903750181198, 验证集损失: 0.094483882188797, 测试集损失: 0.025457290932536125, 用时: 24.23s
验证损失降低 (0.101491 --> 0.094484).  保存模型 于checkpoints/weather_720_96_4_21_mlp/checkpoint.ckpt
第5/30轮
当前学习率调整为：0.0128
训练集损失: 0.12029649317264557, 验证集损失: 0.09362076967954636, 测试集损失: 0.025427673012018204, 用时: 24.63s
验证损失降低 (0.094484 --> 0.093621).  保存模型 于checkpoints/weather_720_96_4_21_mlp/checkpoint.ckpt
第6/30轮
当前学习率调整为：0.01024
训练集损失: 0.11904337257146835, 验证集损失: 0.0936930775642395, 测试集损失: 0.025233082473278046, 用时: 24.74s
早停轮次: 1 out of 5
第7/30轮
当前学习率调整为：0.008192
训练集损失: 0.1188543513417244, 验证集损失: 0.09399537742137909, 测试集损失: 0.02531258575618267, 用时: 24.80s
早停轮次: 2 out of 5
第8/30轮
当前学习率调整为：0.0065536
训练集损失: 0.11522374302148819, 验证集损失: 0.09139146655797958, 测试集损失: 0.02448735199868679, 用时: 24.72s
验证损失降低 (0.093621 --> 0.091391).  保存模型 于checkpoints/weather_720_96_4_21_mlp/checkpoint.ckpt
第9/30轮
当前学习率调整为：0.00524288
训练集损失: 0.11482154577970505, 验证集损失: 0.09119617193937302, 测试集损失: 0.025195131078362465, 用时: 25.39s
验证损失降低 (0.091391 --> 0.091196).  保存模型 于checkpoints/weather_720_96_4_21_mlp/checkpoint.ckpt
第10/30轮
当前学习率调整为：0.004194304
训练集损失: 0.11551488935947418, 验证集损失: 0.0910719633102417, 测试集损失: 0.024866674095392227, 用时: 25.96s
验证损失降低 (0.091196 --> 0.091072).  保存模型 于checkpoints/weather_720_96_4_21_mlp/checkpoint.ckpt
第11/30轮
当前学习率调整为：0.0033554432
训练集损失: 0.113170325756073, 验证集损失: 0.09052804857492447, 测试集损失: 0.024907967075705528, 用时: 24.99s
结果图已保存到 train_result/weather_720_96_4_21_mlp/result_11.pdf
验证损失降低 (0.091072 --> 0.090528).  保存模型 于checkpoints/weather_720_96_4_21_mlp/checkpoint.ckpt
第12/30轮
当前学习率调整为：0.0026843545
训练集损失: 0.11243043839931488, 验证集损失: 0.09004426002502441, 测试集损失: 0.024590596556663513, 用时: 26.10s
验证损失降低 (0.090528 --> 0.090044).  保存模型 于checkpoints/weather_720_96_4_21_mlp/checkpoint.ckpt
第13/30轮
当前学习率调整为：0.0021474836
训练集损失: 0.11325225234031677, 验证集损失: 0.09098799526691437, 测试集损失: 0.02495660074055195, 用时: 25.93s
早停轮次: 1 out of 5
第14/30轮
当前学习率调整为：0.0017179869
训练集损失: 0.11147154122591019, 验证集损失: 0.09011334180831909, 测试集损失: 0.02496950514614582, 用时: 25.93s
早停轮次: 2 out of 5
第15/30轮
当前学习率调整为：0.0013743895
训练集损失: 0.11087016016244888, 验证集损失: 0.08938160538673401, 测试集损失: 0.024707576259970665, 用时: 26.29s
验证损失降低 (0.090044 --> 0.089382).  保存模型 于checkpoints/weather_720_96_4_21_mlp/checkpoint.ckpt
第16/30轮
当前学习率调整为：0.0010995116
训练集损失: 0.11142034828662872, 验证集损失: 0.08965054154396057, 测试集损失: 0.024733368307352066, 用时: 24.84s
早停轮次: 1 out of 5
第17/30轮
当前学习率调整为：0.0008796093
训练集损失: 0.1114111915230751, 验证集损失: 0.09051266312599182, 测试集损失: 0.02467901073396206, 用时: 27.81s
早停轮次: 2 out of 5
第18/30轮
当前学习率调整为：0.00070368743
训练集损失: 0.11072885990142822, 验证集损失: 0.08987521380186081, 测试集损失: 0.02474021725356579, 用时: 27.07s
早停轮次: 3 out of 5
第19/30轮
当前学习率调整为：0.00056295
训练集损失: 0.11080167442560196, 验证集损失: 0.09058129042387009, 测试集损失: 0.024580800905823708, 用时: 26.53s
早停轮次: 4 out of 5
第20/30轮
当前学习率调整为：0.00045035995
训练集损失: 0.11091502010822296, 验证集损失: 0.09026101231575012, 测试集损失: 0.024684296920895576, 用时: 26.52s
早停轮次: 5 out of 5
Early stopping
训练完成！
>>>>>>>>>开始测试>>>>>>>>>
测试集损失: 0.024707576259970665
结果图已保存到 test_result/weather_720_96_4_21_mlp/result_0.pdf
任务2数据集输入数据形状：(51785, 720, 21)，输出数据形状：(51785, 192, 21)
任务2训练集样本数：31071，验证集样本数：10357，测试集样本数：10357
Configs(seq_len=720, pred_len=192, enc_in=21, period_len=4, train_epochs=30, patience=5, flearning_rate=0.02, dataset_name=weather,model_type='mlp')
每个 epoch 的 step 数量: 122
>>>>>>>>>开始训练>>>>>>>>>
第1/30轮
当前学习率调整为：0.02
训练集损失: 0.14876426756381989, 验证集损失: 0.12327408790588379, 测试集损失: 0.034155286848545074, 用时: 28.66s
结果图已保存到 train_result/weather_720_192_4_21_mlp/result_1.pdf
验证损失降低 (inf --> 0.123274).  保存模型 于checkpoints/weather_720_192_4_21_mlp/checkpoint.ckpt
第2/30轮
当前学习率调整为：0.02
训练集损失: 0.13567127287387848, 验证集损失: 0.11627930402755737, 测试集损失: 0.0321025513112545, 用时: 27.36s
验证损失降低 (0.123274 --> 0.116279).  保存模型 于checkpoints/weather_720_192_4_21_mlp/checkpoint.ckpt
第3/30轮
当前学习率调整为：0.02
训练集损失: 0.12889017164707184, 验证集损失: 0.1139633059501648, 测试集损失: 0.031412266194820404, 用时: 27.52s
验证损失降低 (0.116279 --> 0.113963).  保存模型 于checkpoints/weather_720_192_4_21_mlp/checkpoint.ckpt
第4/30轮
当前学习率调整为：0.016
训练集损失: 0.12215514481067657, 验证集损失: 0.10991518199443817, 测试集损失: 0.030045505613088608, 用时: 27.55s
验证损失降低 (0.113963 --> 0.109915).  保存模型 于checkpoints/weather_720_192_4_21_mlp/checkpoint.ckpt
第5/30轮
当前学习率调整为：0.0128
训练集损失: 0.12301429361104965, 验证集损失: 0.10931051522493362, 测试集损失: 0.03138403594493866, 用时: 27.87s
验证损失降低 (0.109915 --> 0.109311).  保存模型 于checkpoints/weather_720_192_4_21_mlp/checkpoint.ckpt
第6/30轮
当前学习率调整为：0.01024
训练集损失: 0.12120428681373596, 验证集损失: 0.10896503180265427, 测试集损失: 0.03060274012386799, 用时: 26.35s
验证损失降低 (0.109311 --> 0.108965).  保存模型 于checkpoints/weather_720_192_4_21_mlp/checkpoint.ckpt
第7/30轮
当前学习率调整为：0.008192
训练集损失: 0.11683452129364014, 验证集损失: 0.10614199191331863, 测试集损失: 0.02940560318529606, 用时: 23.80s
验证损失降低 (0.108965 --> 0.106142).  保存模型 于checkpoints/weather_720_192_4_21_mlp/checkpoint.ckpt
第8/30轮
当前学习率调整为：0.0065536
训练集损失: 0.11692358553409576, 验证集损失: 0.10597598552703857, 测试集损失: 0.029575644060969353, 用时: 23.85s
验证损失降低 (0.106142 --> 0.105976).  保存模型 于checkpoints/weather_720_192_4_21_mlp/checkpoint.ckpt
第9/30轮
当前学习率调整为：0.00524288
训练集损失: 0.11422055959701538, 验证集损失: 0.10400507599115372, 测试集损失: 0.02920583076775074, 用时: 23.71s
验证损失降低 (0.105976 --> 0.104005).  保存模型 于checkpoints/weather_720_192_4_21_mlp/checkpoint.ckpt
第10/30轮
当前学习率调整为：0.004194304
训练集损失: 0.11623077094554901, 验证集损失: 0.10719181597232819, 测试集损失: 0.02936261147260666, 用时: 23.61s
早停轮次: 1 out of 5
第11/30轮
当前学习率调整为：0.0033554432
训练集损失: 0.1142798587679863, 验证集损失: 0.10462890565395355, 测试集损失: 0.029251864179968834, 用时: 23.79s
结果图已保存到 train_result/weather_720_192_4_21_mlp/result_11.pdf
早停轮次: 2 out of 5
第12/30轮
当前学习率调整为：0.0026843545
训练集损失: 0.11459072679281235, 验证集损失: 0.1054396852850914, 测试集损失: 0.029397308826446533, 用时: 23.92s
早停轮次: 3 out of 5
第13/30轮
当前学习率调整为：0.0021474836
训练集损失: 0.11439170688390732, 验证集损失: 0.10559596121311188, 测试集损失: 0.029110319912433624, 用时: 23.87s
早停轮次: 4 out of 5
第14/30轮
当前学习率调整为：0.0017179869
训练集损失: 0.11411513388156891, 验证集损失: 0.10544075071811676, 测试集损失: 0.029091089963912964, 用时: 23.89s
早停轮次: 5 out of 5
Early stopping
训练完成！
>>>>>>>>>开始测试>>>>>>>>>
测试集损失: 0.02920583076775074
结果图已保存到 test_result/weather_720_192_4_21_mlp/result_0.pdf
任务3数据集输入数据形状：(51641, 720, 21)，输出数据形状：(51641, 336, 21)
任务3训练集样本数：30984，验证集样本数：10328，测试集样本数：10329
Configs(seq_len=720, pred_len=336, enc_in=21, period_len=4, train_epochs=30, patience=5, flearning_rate=0.02, dataset_name=weather,model_type='mlp')
每个 epoch 的 step 数量: 122
>>>>>>>>>开始训练>>>>>>>>>
第1/30轮
当前学习率调整为：0.02
训练集损失: 0.14652320742607117, 验证集损失: 0.15879878401756287, 测试集损失: 0.03515693545341492, 用时: 27.49s
结果图已保存到 train_result/weather_720_336_4_21_mlp/result_1.pdf
验证损失降低 (inf --> 0.158799).  保存模型 于checkpoints/weather_720_336_4_21_mlp/checkpoint.ckpt
第2/30轮
当前学习率调整为：0.02
训练集损失: 0.12723974883556366, 验证集损失: 0.13018573820590973, 测试集损失: 0.03408175706863403, 用时: 27.39s
验证损失降低 (0.158799 --> 0.130186).  保存模型 于checkpoints/weather_720_336_4_21_mlp/checkpoint.ckpt
第3/30轮
当前学习率调整为：0.02
训练集损失: 0.13647983968257904, 验证集损失: 0.14660784602165222, 测试集损失: 0.032876525074243546, 用时: 28.36s
早停轮次: 1 out of 5
第4/30轮
当前学习率调整为：0.016
训练集损失: 0.131299689412117, 验证集损失: 0.13795289397239685, 测试集损失: 0.033239029347896576, 用时: 31.28s
早停轮次: 2 out of 5
第5/30轮
当前学习率调整为：0.0128
训练集损失: 0.12536047399044037, 验证集损失: 0.13157819211483002, 测试集损失: 0.03289860486984253, 用时: 31.39s
早停轮次: 3 out of 5
第6/30轮
当前学习率调整为：0.01024
训练集损失: 0.12142755836248398, 验证集损失: 0.12478546798229218, 测试集损失: 0.03390967473387718, 用时: 30.56s
验证损失降低 (0.130186 --> 0.124785).  保存模型 于checkpoints/weather_720_336_4_21_mlp/checkpoint.ckpt
第7/30轮
当前学习率调整为：0.008192
训练集损失: 0.12583127617835999, 验证集损失: 0.13325169682502747, 测试集损失: 0.032114025205373764, 用时: 27.29s
早停轮次: 1 out of 5
第8/30轮
当前学习率调整为：0.0065536
训练集损失: 0.1201476976275444, 验证集损失: 0.12549564242362976, 测试集损失: 0.03180282562971115, 用时: 27.47s
早停轮次: 2 out of 5
第9/30轮
当前学习率调整为：0.00524288
训练集损失: 0.12201038748025894, 验证集损失: 0.13008606433868408, 测试集损失: 0.03198370337486267, 用时: 31.11s
早停轮次: 3 out of 5
第10/30轮
当前学习率调整为：0.004194304
训练集损失: 0.11730867624282837, 验证集损失: 0.12254831194877625, 测试集损失: 0.031685709953308105, 用时: 31.65s
验证损失降低 (0.124785 --> 0.122548).  保存模型 于checkpoints/weather_720_336_4_21_mlp/checkpoint.ckpt
第11/30轮
当前学习率调整为：0.0033554432
训练集损失: 0.11882495135068893, 验证集损失: 0.1242642030119896, 测试集损失: 0.03175332397222519, 用时: 31.40s
结果图已保存到 train_result/weather_720_336_4_21_mlp/result_11.pdf
早停轮次: 1 out of 5
第12/30轮
当前学习率调整为：0.0026843545
训练集损失: 0.1195509135723114, 验证集损失: 0.12590399384498596, 测试集损失: 0.031237445771694183, 用时: 31.44s
早停轮次: 2 out of 5
第13/30轮
当前学习率调整为：0.0021474836
训练集损失: 0.11882652342319489, 验证集损失: 0.12481026351451874, 测试集损失: 0.03126687556505203, 用时: 31.53s
早停轮次: 3 out of 5
第14/30轮
当前学习率调整为：0.0017179869
训练集损失: 0.11801888793706894, 验证集损失: 0.12415789812803268, 测试集损失: 0.031200185418128967, 用时: 31.50s
早停轮次: 4 out of 5
第15/30轮
当前学习率调整为：0.0013743895
训练集损失: 0.11738530546426773, 验证集损失: 0.12315727770328522, 测试集损失: 0.031405169516801834, 用时: 32.06s
早停轮次: 5 out of 5
Early stopping
训练完成！
>>>>>>>>>开始测试>>>>>>>>>
测试集损失: 0.031685709953308105
结果图已保存到 test_result/weather_720_336_4_21_mlp/result_0.pdf
任务4数据集输入数据形状：(51257, 720, 21)，输出数据形状：(51257, 720, 21)
任务4训练集样本数：30754，验证集样本数：10251，测试集样本数：10252
Configs(seq_len=720, pred_len=720, enc_in=21, period_len=4, train_epochs=30, patience=5, flearning_rate=0.02, dataset_name=weather,model_type='mlp')
每个 epoch 的 step 数量: 121
>>>>>>>>>开始训练>>>>>>>>>
第1/30轮
当前学习率调整为：0.02
训练集损失: 0.13918152451515198, 验证集损失: 0.16165335476398468, 测试集损失: 0.03878174349665642, 用时: 46.53s
结果图已保存到 train_result/weather_720_720_4_21_mlp/result_1.pdf
验证损失降低 (inf --> 0.161653).  保存模型 于checkpoints/weather_720_720_4_21_mlp/checkpoint.ckpt
第2/30轮
当前学习率调整为：0.02
训练集损失: 0.13971495628356934, 验证集损失: 0.16108140349388123, 测试集损失: 0.03849299997091293, 用时: 43.43s
验证损失降低 (0.161653 --> 0.161081).  保存模型 于checkpoints/weather_720_720_4_21_mlp/checkpoint.ckpt
第3/30轮
当前学习率调整为：0.02
训练集损失: 0.13672611117362976, 验证集损失: 0.1573452353477478, 测试集损失: 0.03966457024216652, 用时: 43.83s
验证损失降低 (0.161081 --> 0.157345).  保存模型 于checkpoints/weather_720_720_4_21_mlp/checkpoint.ckpt
第4/30轮
当前学习率调整为：0.016
训练集损失: 0.1305963397026062, 验证集损失: 0.14907068014144897, 测试集损失: 0.039365243166685104, 用时: 43.01s
验证损失降低 (0.157345 --> 0.149071).  保存模型 于checkpoints/weather_720_720_4_21_mlp/checkpoint.ckpt
第5/30轮
当前学习率调整为：0.0128
训练集损失: 0.12564048171043396, 验证集损失: 0.14549784362316132, 测试集损失: 0.038494568318128586, 用时: 40.68s
验证损失降低 (0.149071 --> 0.145498).  保存模型 于checkpoints/weather_720_720_4_21_mlp/checkpoint.ckpt
第6/30轮
当前学习率调整为：0.01024
训练集损失: 0.1264415979385376, 验证集损失: 0.1468246728181839, 测试集损失: 0.038979846984148026, 用时: 42.80s
早停轮次: 1 out of 5
第7/30轮
当前学习率调整为：0.008192
训练集损失: 0.12332682311534882, 验证集损失: 0.14394956827163696, 测试集损失: 0.03834061324596405, 用时: 43.02s
验证损失降低 (0.145498 --> 0.143950).  保存模型 于checkpoints/weather_720_720_4_21_mlp/checkpoint.ckpt
第8/30轮
当前学习率调整为：0.0065536
训练集损失: 0.12087210267782211, 验证集损失: 0.1410408467054367, 测试集损失: 0.0384318046271801, 用时: 42.81s
验证损失降低 (0.143950 --> 0.141041).  保存模型 于checkpoints/weather_720_720_4_21_mlp/checkpoint.ckpt
第9/30轮
当前学习率调整为：0.00524288
训练集损失: 0.11916524916887283, 验证集损失: 0.1388579159975052, 测试集损失: 0.038270026445388794, 用时: 42.81s
验证损失降低 (0.141041 --> 0.138858).  保存模型 于checkpoints/weather_720_720_4_21_mlp/checkpoint.ckpt
第10/30轮
当前学习率调整为：0.004194304
训练集损失: 0.11789794266223907, 验证集损失: 0.1376405507326126, 测试集损失: 0.03810685873031616, 用时: 43.12s
验证损失降低 (0.138858 --> 0.137641).  保存模型 于checkpoints/weather_720_720_4_21_mlp/checkpoint.ckpt
第11/30轮
当前学习率调整为：0.0033554432
训练集损失: 0.11856399476528168, 验证集损失: 0.1388196349143982, 测试集损失: 0.038339365273714066, 用时: 43.32s
结果图已保存到 train_result/weather_720_720_4_21_mlp/result_11.pdf
早停轮次: 1 out of 5
第12/30轮
当前学习率调整为：0.0026843545
训练集损失: 0.1168534979224205, 验证集损失: 0.13692347705364227, 测试集损失: 0.03832187503576279, 用时: 42.89s
验证损失降低 (0.137641 --> 0.136923).  保存模型 于checkpoints/weather_720_720_4_21_mlp/checkpoint.ckpt
第13/30轮
当前学习率调整为：0.0021474836
训练集损失: 0.11700715124607086, 验证集损失: 0.13724230229854584, 测试集损失: 0.03857799991965294, 用时: 42.92s
早停轮次: 1 out of 5
第14/30轮
当前学习率调整为：0.0017179869
训练集损失: 0.11774881184101105, 验证集损失: 0.13844850659370422, 测试集损失: 0.038607142865657806, 用时: 43.05s
早停轮次: 2 out of 5
第15/30轮
当前学习率调整为：0.0013743895
训练集损失: 0.1155540719628334, 验证集损失: 0.13547608256340027, 测试集损失: 0.038411032408475876, 用时: 43.53s
验证损失降低 (0.136923 --> 0.135476).  保存模型 于checkpoints/weather_720_720_4_21_mlp/checkpoint.ckpt
第16/30轮
当前学习率调整为：0.0010995116
训练集损失: 0.11620483547449112, 验证集损失: 0.13634778559207916, 测试集损失: 0.03841867297887802, 用时: 43.25s
早停轮次: 1 out of 5
第17/30轮
当前学习率调整为：0.0008796093
训练集损失: 0.11597695201635361, 验证集损失: 0.13646003603935242, 测试集损失: 0.03855087235569954, 用时: 43.50s
早停轮次: 2 out of 5
第18/30轮
当前学习率调整为：0.00070368743
训练集损失: 0.1160178929567337, 验证集损失: 0.13660235702991486, 测试集损失: 0.03846070170402527, 用时: 43.76s
早停轮次: 3 out of 5
第19/30轮
当前学习率调整为：0.00056295
训练集损失: 0.11564134806394577, 验证集损失: 0.1362752616405487, 测试集损失: 0.03840368613600731, 用时: 43.77s
早停轮次: 4 out of 5
第20/30轮
当前学习率调整为：0.00045035995
训练集损失: 0.11537874490022659, 验证集损失: 0.13600483536720276, 测试集损失: 0.03841681405901909, 用时: 37.35s
早停轮次: 5 out of 5
Early stopping
训练完成！
>>>>>>>>>开始测试>>>>>>>>>
测试集损失: 0.038411032408475876
结果图已保存到 test_result/weather_720_720_4_21_mlp/result_0.pdf