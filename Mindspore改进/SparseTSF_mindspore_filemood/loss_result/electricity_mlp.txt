数据形状：(26304, 321)，元素类型：float32
任务1数据集输入数据形状：(25489, 720, 321)，输出数据形状：(25489, 96, 321)
任务1训练集样本数：15293，验证集样本数：5098，测试集样本数：5098
Configs(seq_len=720, pred_len=96, enc_in=321, period_len=24, train_epochs=30, patience=5, flearning_rate=0.02, dataset_name=electricity,model_type='mlp')
每个 epoch 的 step 数量: 239
>>>>>>>>>开始训练>>>>>>>>>
第1/30轮
当前学习率调整为：0.02
训练集损失: 0.32998523116111755, 验证集损失: 0.23206590116024017, 测试集损失: 0.30814892053604126, 用时: 265.51s
结果图已保存到 train_result/electricity_720_96_24_321_mlp/result_1.pdf
验证损失降低 (inf --> 0.232066).  保存模型 于checkpoints/electricity_720_96_24_321_mlp/checkpoint.ckpt
第2/30轮
当前学习率调整为：0.02
训练集损失: 0.32845941185951233, 验证集损失: 0.2316797822713852, 测试集损失: 0.3099476993083954, 用时: 272.31s
验证损失降低 (0.232066 --> 0.231680).  保存模型 于checkpoints/electricity_720_96_24_321_mlp/checkpoint.ckpt
第3/30轮
当前学习率调整为：0.02
训练集损失: 0.32789960503578186, 验证集损失: 0.2317391335964203, 测试集损失: 0.3087118864059448, 用时: 253.55s
早停轮次: 1 out of 5
第4/30轮
当前学习率调整为：0.016
训练集损失: 0.32912325859069824, 验证集损失: 0.23257368803024292, 测试集损失: 0.31302160024642944, 用时: 264.09s
早停轮次: 2 out of 5
第5/30轮
当前学习率调整为：0.0128
训练集损失: 0.3288106322288513, 验证集损失: 0.23194341361522675, 测试集损失: 0.31074848771095276, 用时: 249.81s
早停轮次: 3 out of 5
第6/30轮
当前学习率调整为：0.01024
训练集损失: 0.32841551303863525, 验证集损失: 0.23159047961235046, 测试集损失: 0.308998703956604, 用时: 243.11s
验证损失降低 (0.231680 --> 0.231590).  保存模型 于checkpoints/electricity_720_96_24_321_mlp/checkpoint.ckpt
第7/30轮
当前学习率调整为：0.008192
训练集损失: 0.3274131417274475, 验证集损失: 0.23182310163974762, 测试集损失: 0.31093829870224, 用时: 243.91s
早停轮次: 1 out of 5
第8/30轮
当前学习率调整为：0.0065536
训练集损失: 0.3283229172229767, 验证集损失: 0.23097582161426544, 测试集损失: 0.3084949553012848, 用时: 246.94s
验证损失降低 (0.231590 --> 0.230976).  保存模型 于checkpoints/electricity_720_96_24_321_mlp/checkpoint.ckpt
第9/30轮
当前学习率调整为：0.00524288
训练集损失: 0.3276122808456421, 验证集损失: 0.22944143414497375, 测试集损失: 0.30651426315307617, 用时: 239.94s
验证损失降低 (0.230976 --> 0.229441).  保存模型 于checkpoints/electricity_720_96_24_321_mlp/checkpoint.ckpt
第10/30轮
当前学习率调整为：0.004194304
训练集损失: 0.32631492614746094, 验证集损失: 0.2301619052886963, 测试集损失: 0.3070068955421448, 用时: 239.70s
早停轮次: 1 out of 5
第11/30轮
当前学习率调整为：0.0033554432
训练集损失: 0.326158344745636, 验证集损失: 0.23023167252540588, 测试集损失: 0.30682310461997986, 用时: 242.92s
结果图已保存到 train_result/electricity_720_96_24_321_mlp/result_11.pdf
早停轮次: 2 out of 5
第12/30轮
当前学习率调整为：0.0026843545
训练集损失: 0.3269438147544861, 验证集损失: 0.2295333445072174, 测试集损失: 0.306083619594574, 用时: 241.96s
早停轮次: 3 out of 5
第13/30轮
当前学习率调整为：0.0021474836
训练集损失: 0.32770583033561707, 验证集损失: 0.2311062067747116, 测试集损失: 0.3082066774368286, 用时: 249.90s
早停轮次: 4 out of 5
第14/30轮
当前学习率调整为：0.0017179869
训练集损失: 0.326204776763916, 验证集损失: 0.22985006868839264, 测试集损失: 0.3064787685871124, 用时: 249.41s
早停轮次: 5 out of 5
Early stopping
训练完成！
>>>>>>>>>开始测试>>>>>>>>>
测试集损失: 0.30651426315307617
结果图已保存到 test_result/electricity_720_96_24_321_mlp/result_0.pdf
任务2数据集输入数据形状：(25393, 720, 321)，输出数据形状：(25393, 192, 321)
任务2训练集样本数：15235，验证集样本数：5079，测试集样本数：5079
Configs(seq_len=720, pred_len=192, enc_in=321, period_len=24, train_epochs=30, patience=5, flearning_rate=0.02, dataset_name=electricity,model_type='mlp')
每个 epoch 的 step 数量: 239
>>>>>>>>>开始训练>>>>>>>>>
第1/30轮
当前学习率调整为：0.02
训练集损失: 0.35037893056869507, 验证集损失: 0.24780802428722382, 测试集损失: 0.32440173625946045, 用时: 282.59s
结果图已保存到 train_result/electricity_720_192_24_321_mlp/result_1.pdf
验证损失降低 (inf --> 0.247808).  保存模型 于checkpoints/electricity_720_192_24_321_mlp/checkpoint.ckpt
第2/30轮
当前学习率调整为：0.02
训练集损失: 0.35412830114364624, 验证集损失: 0.2528764009475708, 测试集损失: 0.331572026014328, 用时: 272.56s
早停轮次: 1 out of 5
第3/30轮
当前学习率调整为：0.02
训练集损失: 0.3542495667934418, 验证集损失: 0.25150954723358154, 测试集损失: 0.33125630021095276, 用时: 273.71s
早停轮次: 2 out of 5
第4/30轮
当前学习率调整为：0.016
训练集损失: 0.35230934619903564, 验证集损失: 0.2490149438381195, 测试集损失: 0.3326631188392639, 用时: 263.23s
早停轮次: 3 out of 5
第5/30轮
当前学习率调整为：0.0128
训练集损失: 0.3493894338607788, 验证集损失: 0.247108593583107, 测试集损失: 0.32832127809524536, 用时: 1135.00s
验证损失降低 (0.247808 --> 0.247109).  保存模型 于checkpoints/electricity_720_192_24_321_mlp/checkpoint.ckpt
第6/30轮
当前学习率调整为：0.01024
训练集损失: 0.3517799377441406, 验证集损失: 0.25058287382125854, 测试集损失: 0.3328110873699188, 用时: 311.01s
早停轮次: 1 out of 5
第7/30轮
当前学习率调整为：0.008192
训练集损失: 0.34810715913772583, 验证集损失: 0.24707408249378204, 测试集损失: 0.325546532869339, 用时: 295.26s
验证损失降低 (0.247109 --> 0.247074).  保存模型 于checkpoints/electricity_720_192_24_321_mlp/checkpoint.ckpt
第8/30轮
当前学习率调整为：0.0065536
训练集损失: 0.34870877861976624, 验证集损失: 0.24782322347164154, 测试集损失: 0.3300471603870392, 用时: 287.21s
早停轮次: 1 out of 5
第9/30轮
当前学习率调整为：0.00524288
训练集损失: 0.34863632917404175, 验证集损失: 0.24580195546150208, 测试集损失: 0.3278171122074127, 用时: 296.41s
验证损失降低 (0.247074 --> 0.245802).  保存模型 于checkpoints/electricity_720_192_24_321_mlp/checkpoint.ckpt
第10/30轮
当前学习率调整为：0.004194304
训练集损失: 0.34913501143455505, 验证集损失: 0.24768532812595367, 测试集损失: 0.3275606036186218, 用时: 339.90s
早停轮次: 1 out of 5
第11/30轮
当前学习率调整为：0.0033554432
训练集损失: 0.34837213158607483, 验证集损失: 0.24561713635921478, 测试集损失: 0.32522526383399963, 用时: 335.29s
结果图已保存到 train_result/electricity_720_192_24_321_mlp/result_11.pdf
验证损失降低 (0.245802 --> 0.245617).  保存模型 于checkpoints/electricity_720_192_24_321_mlp/checkpoint.ckpt
第12/30轮
当前学习率调整为：0.0026843545
训练集损失: 0.34784528613090515, 验证集损失: 0.24700729548931122, 测试集损失: 0.3278990089893341, 用时: 336.52s
早停轮次: 1 out of 5
第13/30轮
当前学习率调整为：0.0021474836
训练集损失: 0.34765443205833435, 验证集损失: 0.24637369811534882, 测试集损失: 0.3276173770427704, 用时: 337.68s
早停轮次: 2 out of 5
第14/30轮
当前学习率调整为：0.0017179869
训练集损失: 0.34730082750320435, 验证集损失: 0.24674642086029053, 测试集损失: 0.3276466429233551, 用时: 348.54s
早停轮次: 3 out of 5
第15/30轮
当前学习率调整为：0.0013743895
训练集损失: 0.34761208295822144, 验证集损失: 0.24587315320968628, 测试集损失: 0.3262190818786621, 用时: 345.25s
早停轮次: 4 out of 5
第16/30轮
当前学习率调整为：0.0010995116
训练集损失: 0.3474152982234955, 验证集损失: 0.2471947968006134, 测试集损失: 0.32810187339782715, 用时: 348.79s
早停轮次: 5 out of 5
Early stopping
训练完成！
>>>>>>>>>开始测试>>>>>>>>>
测试集损失: 0.32522526383399963
结果图已保存到 test_result/electricity_720_192_24_321_mlp/result_0.pdf
任务3数据集输入数据形状：(25249, 720, 321)，输出数据形状：(25249, 336, 321)
任务3训练集样本数：15149，验证集样本数：5050，测试集样本数：5050
Configs(seq_len=720, pred_len=336, enc_in=321, period_len=24, train_epochs=30, patience=5, flearning_rate=0.02, dataset_name=electricity,model_type='mlp')
每个 epoch 的 step 数量: 237
>>>>>>>>>开始训练>>>>>>>>>
第1/30轮
当前学习率调整为：0.02
训练集损失: 0.37593626976013184, 验证集损失: 0.26507681608200073, 测试集损失: 0.34954625368118286, 用时: 428.51s
结果图已保存到 train_result/electricity_720_336_24_321_mlp/result_1.pdf
验证损失降低 (inf --> 0.265077).  保存模型 于checkpoints/electricity_720_336_24_321_mlp/checkpoint.ckpt
第2/30轮
当前学习率调整为：0.02
训练集损失: 0.3748970329761505, 验证集损失: 0.264596164226532, 测试集损失: 0.35167473554611206, 用时: 355.77s
验证损失降低 (0.265077 --> 0.264596).  保存模型 于checkpoints/electricity_720_336_24_321_mlp/checkpoint.ckpt
第3/30轮
当前学习率调整为：0.02
训练集损失: 0.37598609924316406, 验证集损失: 0.2639056146144867, 测试集损失: 0.3509175479412079, 用时: 324.57s
验证损失降低 (0.264596 --> 0.263906).  保存模型 于checkpoints/electricity_720_336_24_321_mlp/checkpoint.ckpt
第4/30轮
当前学习率调整为：0.016
训练集损失: 0.3737228214740753, 验证集损失: 0.26429283618927, 测试集损失: 0.3506149351596832, 用时: 327.57s
早停轮次: 1 out of 5
第5/30轮
当前学习率调整为：0.0128
训练集损失: 0.3735775053501129, 验证集损失: 0.2625501751899719, 测试集损失: 0.3514346778392792, 用时: 389.37s
验证损失降低 (0.263906 --> 0.262550).  保存模型 于checkpoints/electricity_720_336_24_321_mlp/checkpoint.ckpt
第6/30轮
当前学习率调整为：0.01024
训练集损失: 0.37305185198783875, 验证集损失: 0.26364338397979736, 测试集损失: 0.35453540086746216, 用时: 397.88s
早停轮次: 1 out of 5
第7/30轮
当前学习率调整为：0.008192
训练集损失: 0.3723723292350769, 验证集损失: 0.2633672058582306, 测试集损失: 0.3527970016002655, 用时: 377.92s
早停轮次: 2 out of 5
第8/30轮
当前学习率调整为：0.0065536
训练集损失: 0.3725764751434326, 验证集损失: 0.26351383328437805, 测试集损失: 0.35450032353401184, 用时: 363.11s
早停轮次: 3 out of 5
第9/30轮
当前学习率调整为：0.00524288
训练集损失: 0.37166687846183777, 验证集损失: 0.2634255588054657, 测试集损失: 0.351095974445343, 用时: 324.84s
早停轮次: 4 out of 5
第10/30轮
当前学习率调整为：0.004194304
训练集损失: 0.3718356788158417, 验证集损失: 0.2623785138130188, 测试集损失: 0.35131192207336426, 用时: 328.51s
验证损失降低 (0.262550 --> 0.262379).  保存模型 于checkpoints/electricity_720_336_24_321_mlp/checkpoint.ckpt
第11/30轮
当前学习率调整为：0.0033554432
训练集损失: 0.3709718883037567, 验证集损失: 0.2622416019439697, 测试集损失: 0.35066506266593933, 用时: 325.29s
结果图已保存到 train_result/electricity_720_336_24_321_mlp/result_11.pdf
验证损失降低 (0.262379 --> 0.262242).  保存模型 于checkpoints/electricity_720_336_24_321_mlp/checkpoint.ckpt
第12/30轮
当前学习率调整为：0.0026843545
训练集损失: 0.3716922700405121, 验证集损失: 0.26329898834228516, 测试集损失: 0.35186734795570374, 用时: 325.11s
早停轮次: 1 out of 5
第13/30轮
当前学习率调整为：0.0021474836
训练集损失: 0.3717573583126068, 验证集损失: 0.26218098402023315, 测试集损失: 0.3511941730976105, 用时: 321.17s
验证损失降低 (0.262242 --> 0.262181).  保存模型 于checkpoints/electricity_720_336_24_321_mlp/checkpoint.ckpt
第14/30轮
当前学习率调整为：0.0017179869
训练集损失: 0.3715646266937256, 验证集损失: 0.26288172602653503, 测试集损失: 0.3515954911708832, 用时: 319.74s
早停轮次: 1 out of 5
第15/30轮
当前学习率调整为：0.0013743895
训练集损失: 0.37200817465782166, 验证集损失: 0.26262572407722473, 测试集损失: 0.35154595971107483, 用时: 344.28s
早停轮次: 2 out of 5
第16/30轮
当前学习率调整为：0.0010995116
训练集损失: 0.371945858001709, 验证集损失: 0.26290422677993774, 测试集损失: 0.3521053194999695, 用时: 323.24s
早停轮次: 3 out of 5
第17/30轮
当前学习率调整为：0.0008796093
训练集损失: 0.3722256124019623, 验证集损失: 0.2631905972957611, 测试集损失: 0.3527693748474121, 用时: 325.52s
早停轮次: 4 out of 5
第18/30轮
当前学习率调整为：0.00070368743
训练集损失: 0.3715597689151764, 验证集损失: 0.2629595100879669, 测试集损失: 0.35161954164505005, 用时: 388.73s
早停轮次: 5 out of 5
Early stopping
训练完成！
>>>>>>>>>开始测试>>>>>>>>>
测试集损失: 0.3511941730976105
结果图已保存到 test_result/electricity_720_336_24_321_mlp/result_0.pdf
任务4数据集输入数据形状：(24865, 720, 321)，输出数据形状：(24865, 720, 321)
任务4训练集样本数：14919，验证集样本数：4973，测试集样本数：4973
Configs(seq_len=720, pred_len=720, enc_in=321, period_len=24, train_epochs=30, patience=5, flearning_rate=0.02, dataset_name=electricity,model_type='mlp')
每个 epoch 的 step 数量: 234
>>>>>>>>>开始训练>>>>>>>>>
第1/30轮
当前学习率调整为：0.02
训练集损失: 0.4332938492298126, 验证集损失: 0.26918911933898926, 测试集损失: 0.4198920428752899, 用时: 494.85s
结果图已保存到 train_result/electricity_720_720_24_321_mlp/result_1.pdf
验证损失降低 (inf --> 0.269189).  保存模型 于checkpoints/electricity_720_720_24_321_mlp/checkpoint.ckpt
第2/30轮
当前学习率调整为：0.02
训练集损失: 0.4327358603477478, 验证集损失: 0.2703389823436737, 测试集损失: 0.42021098732948303, 用时: 469.31s
早停轮次: 1 out of 5
第3/30轮
当前学习率调整为：0.02
训练集损失: 0.43316158652305603, 验证集损失: 0.27127206325531006, 测试集损失: 0.4226340651512146, 用时: 473.10s
早停轮次: 2 out of 5
第4/30轮
当前学习率调整为：0.016
训练集损失: 0.43522679805755615, 验证集损失: 0.2717972695827484, 测试集损失: 0.42524048686027527, 用时: 440.51s
早停轮次: 3 out of 5
第5/30轮
当前学习率调整为：0.0128
训练集损失: 0.431846559047699, 验证集损失: 0.27040719985961914, 测试集损失: 0.42429032921791077, 用时: 462.19s
早停轮次: 4 out of 5
第6/30轮
当前学习率调整为：0.01024
训练集损失: 0.4327913224697113, 验证集损失: 0.2706057131290436, 测试集损失: 0.42360758781433105, 用时: 460.32s
早停轮次: 5 out of 5
Early stopping
训练完成！
>>>>>>>>>开始测试>>>>>>>>>
测试集损失: 0.4198920428752899
结果图已保存到 test_result/electricity_720_720_24_321_mlp/result_0.pdf